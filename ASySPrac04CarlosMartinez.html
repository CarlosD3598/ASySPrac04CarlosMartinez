
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ASySPrac04CarlosMartinez</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-11-17"><meta name="DC.source" content="ASySPrac04CarlosMartinez.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1></h1><!--introduction--><p><img vspace="5" hspace="5" src="portada.png" alt=""> </p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Objetivos</a></li><li><a href="#2">Introducci&oacute;n</a></li><li><a href="#3">Desarrollo</a></li><li><a href="#4">Ejercicio 1</a></li><li><a href="#6">Ejercicio 2</a></li><li><a href="#8">Ejercicio 3</a></li><li><a href="#9">Ejercicio 4</a></li><li><a href="#10">Ejercicio 5</a></li><li><a href="#11">Apendice A</a></li><li><a href="#12">Referencias</a></li></ul></div><h2 id="1">Objetivos</h2><div><ul><li>Conocer m&eacute;todos b&aacute;sicos de integrac&iacute;on num&eacute;rica</li><li>Manipulaci&oacute;n de instrucciones en MATLAB</li><li>Simular convoluciones y correlaciones de se&ntilde;ales continuas</li><li>Simular convoluciones y correlaciones de se&ntilde;ales discretas</li></ul></div><h2 id="2">Introducci&oacute;n</h2><p><b>M&eacute;todos num&eacute;ricos</b></p><p><img src="ASySPrac04CarlosMartinez_eq11518683629591826499.png" alt="$\int_{a}^{b}f(x)dx$"> Es el &aacute;rea definida por la gr&aacute;fica de la funci&oacute;n. El teorema fundamental del c&aacute;lculo dice: que si f es integrable y una anti derivada da como resultado la funci&oacute;n f Entonces el numero asociado a la idea geom&eacute;trica evaluado en el intervalo (a,b) se puede calcular como F(b)- F(a) Para encontrar estas antiderivadas se usan t&eacute;cnicas de integraci&oacute;n (cambio de variable, fracciones parciales, sustituci&oacute;n trigonom&eacute;trica) recordando que toda funci&oacute;n continua es integrable.</p><p>De no encontrar la antiderivada, se tiene que tratar de construir un polinomio que al evaluar la funci&oacute;n original sean casi la misma altura, e integrar el polinomio que ser&iacute;a casi id&eacute;ntico a la funci&oacute;n original. En integraci&oacute;n num&eacute;rica sustituyes funciones por polinomios e integramos los polinomios</p><p>Ejemplo: Integracion Numerica <img src="ASySPrac04CarlosMartinez_eq01782560328208573374.png" alt="$\int_{-1}^{1} f(x)dx = \int_{-1}^{1} e^{-x^2}dx = F(1)-F(-1) \quad con \frac{dF(x)}{dx}=f(x)$">; la antiderivada F(x) no existe usando m&eacute;todos de integraci&oacute;n entonces utilizamos la aproximaci&oacute;n de &aacute;rea mediante los polinomios de Lagrage aproximando P(x) nos queda como un rect&aacute;ngulo entonces P(x)=1 entonces:$\int_{-1}^{1} P(x)dx =\int_{-1}^{1}dx = 2$, <img src="ASySPrac04CarlosMartinez_eq10249217983212755489.png" alt="$\int_{-1}^{1} e^{-x^2}dx <2$"> Usando software para hacer la integral nos da que e^{-x^2} dx = 1.49365 por lo que nuestra aproximaci&oacute;n es correcta con casi .5 de error de aproximaci&oacute;n</p><p><b>Formulas cerradas de newton cotes</b></p><p>Se utilizan los polinomios de integraci&oacute;n de legrange para aproximar el polinomio a la funci&oacute;n original <img src="ASySPrac04CarlosMartinez_eq11518683629591826499.png" alt="$\int_{a}^{b}f(x)dx$">, <img src="ASySPrac04CarlosMartinez_eq00134244652034192451.png" alt="$f(x)=P(x)+ \frac{f^{(n+1)} \epsilon(x)}{(n+1)!}(x-x_{0})(x-x_{1})...(x-x_{n})$"> en lugar de integrar la funci&oacute;n integremos el polinomio con el error <img src="ASySPrac04CarlosMartinez_eq04202927574850129020.png" alt="$\epsilon$">, estas f&oacute;rmulas se llaman n m&aacute;s un punto, donde necesitas un punto m&aacute;s del grado del polinomio que se desea</p><p><b>Formula cerrada de (n+1) puntos de Newton Cotes</b></p><p><img src="ASySPrac04CarlosMartinez_eq01056269978726897643.png" alt="$x_{0}=a$">    (punto inicial del intervalo) <img src="ASySPrac04CarlosMartinez_eq00331310322815514266.png" alt="$x_{n}=b$">       (punto final del intervalo) <img src="ASySPrac04CarlosMartinez_eq06681982733906799284.png" alt="$h= \frac{b-a}{n}$">             (paso) <img src="ASySPrac04CarlosMartinez_eq12040677464849082748.png" alt="$x_{i}= x_{0} +ih$">, i=0,1,2,&#8230;,n (puntos intermedios del intervalo) donde cada una de estas x son intervalos de las abscisas y h la separaci&oacute;n entre ellas</p><p><b>Regla del trapecio (n=1)</b></p><p><img src="ASySPrac04CarlosMartinez_eq13891957571088405369.png" alt="$\int_{x_{0}}^{x_{1}}f(x)dx =\frac{h}{2}[f(x_{0})+f(x_{1})]-\frac{h^3}{12}f''(\epsilon)$">, <img src="ASySPrac04CarlosMartinez_eq14157887289034177420.png" alt="$x_{0} < \epsilon < x_{1}$"> es para un polinomio grado 1. Y sustituyendo los polinomios de lagrange se integra toda la funci&oacute;n y se utilizan dos puntos de interpolaci&oacute;n en este caso <img src="ASySPrac04CarlosMartinez_eq14326711717586200669.png" alt="$x_{0}$"> y <img src="ASySPrac04CarlosMartinez_eq15221720655928888702.png" alt="$x_{1}$"> grado de precisi&oacute;n&#8230;&#8230;. Se busca que la aproximaci&oacute;n tenga error 0 la suma de los 2 terminos que nos da esta regla deben aproximarse al calculo de la integral del polinomio del la formula general</p><p><img src="ASySPrac04CarlosMartinez_eq02137212607852333260.png" alt="$\int_{-1}^{1} e^{-x^2}dx=\frac{2}{2}[e^{-1}+e^{-1}]-\frac{8}{12}[-2e^{-\epsilon^{2}}(1-\epsilon^{2})]$">; <img src="ASySPrac04CarlosMartinez_eq16302901959916205662.png" alt="$-1<\epsilon<1$">; entonces: <img src="ASySPrac04CarlosMartinez_eq14292192056853614187.png" alt="$\int_{-1}^{1} e^{-x^2}dx =0.735759 + \frac{4}{3}e^{-\epsilon^{2}}(1-\epsilon^{2})$">; <img src="ASySPrac04CarlosMartinez_eq16302901959916205662.png" alt="$-1<\epsilon<1$"> No sabemos el valor de <img src="ASySPrac04CarlosMartinez_eq04202927574850129020.png" alt="$\epsilon$"> solo que esta entre -1 y 1 la aproximaci&oacute;n es buena pero no la mejor.</p><p><b>Regla de Simpson(n=2)</b></p><p><img src="ASySPrac04CarlosMartinez_eq15246534622700325297.png" alt="$\int_{x_{0}}^{x_{2}}f(x)dx =\frac{h}{3}[f(x_{0})+4f(x_{1})+f(x_{2})]-\frac{h^5}{90}f^{4}(\epsilon)$">, <img src="ASySPrac04CarlosMartinez_eq09999280490593985434.png" alt="$x_{0} < \epsilon < x_{2}$"> para este m&eacute;todo necesitamos 3 intervalos <img src="ASySPrac04CarlosMartinez_eq02913164141712480079.png" alt="$x_{0} , x_{1}$"> y <img src="ASySPrac04CarlosMartinez_eq08159277116585170228.png" alt="$x_{2}$"> usando una par&aacute;bola y buscando el &aacute;rea bajo ella para un polinomio de grado 2</p><p><img src="ASySPrac04CarlosMartinez_eq12052802790095444358.png" alt="$\int_{-1}^{1} e^{-x^2}dx =\frac{1}{3}[e^{-1}+4e^{0}+e^{-1}]-\frac{1}{90}[-4e^{-\epsilon^{2}}(-4\epsilon^{4} +12\epsilon^{2}-3)]\\$">; <img src="ASySPrac04CarlosMartinez_eq16302901959916205662.png" alt="$-1<\epsilon<1$"> Entoces:$\int_{-1}^{1} e^{-x^2}dx =1.57859 - \frac{2}{45}e^{-\epsilon^{2}}(4\epsilon^{4} -12\epsilon^{2}+3)\\$ Esta aproximaci&oacute;n es mejor que la anterior ya que 1.5 es mas cercano a 1.49 que 0.74</p><p><b>Regla de  <img src="ASySPrac04CarlosMartinez_eq00506565279361456927.png" alt="$\frac{3}{8}$"> de simpsons (n=3)</b></p><p><img src="ASySPrac04CarlosMartinez_eq07097030123251031962.png" alt="$\int_{x_{0}}^{x_{3}}f(x)dx =\frac{3}{8}h[f(x_{0})+3f(x_{1})+3f(x_{2})+f(x_{3})]-\frac{3}{80}h^5f^4(\epsilon)$">; <img src="ASySPrac04CarlosMartinez_eq02181874251545886257.png" alt="$x_{0} < \epsilon < x_{3}$"> para grado 3 se necesitan 4 puntos para hacer la aproximaci&oacute;n, <img src="ASySPrac04CarlosMartinez_eq18288984981510484097.png" alt="$x_{0} , x_{1} , x_{2}$"> y <img src="ASySPrac04CarlosMartinez_eq12175366402580885004.png" alt="$x_{3}$"> las formulas de newton cotes son exactas entonces el error es 0 ya que la cuarta derivada de un polinomio grado 3 es 0</p><p>\int_{-1}^{1} e^{-x^2}dx = \frac{3}{8}(\frac{2}{3})[e^{-1}+3e^{\frac{1}{3}}+3e^{\frac{1}{3}}+e^{-1}]-\frac{3}{8}(\frac{2}{3})^2[-4e^{-\epsilon^{2}}(-4\epsilon^{4} +12\epsilon^{2}-3)]\\ Entonces:$\int_{-1}^{1} e^{-x^2}dx =1.768- \frac{8}{405}e^{-\epsilon^{2}}(4\epsilon^{4} -12\epsilon^{2}+3)\\$; La aproximaci&oacute;n ahora es mas exacta ya que pasa por mas puntos.</p><p><b>Regla compuesta del trapecio</b></p><p><img src="ASySPrac04CarlosMartinez_eq00546417995993480066.png" alt="$\int_{a}^{b}f(x)dx =\frac{h}{2}[f(a)+2\sum_{i=1}^{n=1}f(x_{i})+f(b)]-\frac{b-a}{12}h^2 f''(u)$">, <img src="ASySPrac04CarlosMartinez_eq10580662370011136741.png" alt="$u(a,b)$"> Es id&eacute;ntica a la regla del trapecio mencionada antes, solo que en este caso se utilizan m&uacute;ltiples trapecios para aproximar m&aacute;s el valor real de la altura, se manipula el error y el termino de ajuste con lleva la segunda derivada de un numero u entre el intervalo a y b. En este caso la n no es el grado del polinomio si no el n&uacute;mero de subintervalos, damos por hecho que aproximamos con polinomios de primer grado Los puntos intermedios se siguen calculando de la misma manera al igual que el paso.</p><p><img src="ASySPrac04CarlosMartinez_eq17251494051310010725.png" alt="$\int_{-1}^{1} e^{-x^2}dx = \frac{0.2}{2}[e^{-1}+2\sum_{i=1}^{n-1}e^{-x^2_{i}}+e^{-1}]-\frac{2}{12}(0.2)^2[-2e^{-u^{2}}(1-2u^{2})]; -1<u<1$"> Entonces: <img src="ASySPrac04CarlosMartinez_eq08185436278354373428.png" alt="$\int_{-1}^{1} e^{-x^2}dx =1.4887-0.0313e^{-u^{2}}(1-2u^{2})$">; Entre m&aacute;s trapecios usemos mayor ser&aacute; la aproximaci&oacute;n a la funci&oacute;n original</p><p><b>Regla compuesta de Simpson</b></p><p><img src="ASySPrac04CarlosMartinez_eq06520222789497348979.png" alt="$\int_{a}^{b}f(x)dx =\frac{h}{3}[f(a)+2\sum_{i=1}^{(n/2)-1}f(x_{2j})+4\sum_{i=1}^{n/2}f(x_{2j-1})+f(b)]-\frac{b-a}{180}h^4 f^4 (u)$">; <img src="ASySPrac04CarlosMartinez_eq10580662370011136741.png" alt="$u(a,b)$"> Los puntos medios pares forman parte de 2 parabolas entonces se suman 2 veces en la formula y los impares se consideran 4 veces dada a forma de la formula simple de Simpson, De igual manera n es el numero de subintervalos , el paso y distancia entre subintervalos se calculan de igual manera</p><p>\int_{-1}^{1} e^{-x^2}dx = \frac{0.2}{3}[e^{-1}+2\sum_{i=1}^{4}e^{-x^2_{2i}}+4\sum_{i=1}^{5}e^{-x^2_{2i-1}}+e^{-1}]-\frac{2}{180}(0.2)^4[-4e^{-u^{2}}(-4u^{4} +12u^{2}-3)]; -1&lt;u&lt;1$ Entonces: <img src="ASySPrac04CarlosMartinez_eq14478878746284905858.png" alt="$\int_{-1}^{1} e^{-x^2}dx =1.4936-0.00007111e^{-u^{2}}(4u^{4}-12u^{2}+3)$"> Entre m&aacute;s par&aacute;bolas usemos mejor ser&aacute; la aproximaci&oacute;n.</p><p><b>Cuadratura gaussiana</b></p><p><img src="ASySPrac04CarlosMartinez_eq17737949140523175558.png" alt="$\int_{a}^{b}f(x)dx \approx  \sum_{i=1}^{n} C_{i}f(x_{i}); \quad 2n\quad$">  par&aacute;metros Las reglas vistas anteriormente son f&oacute;rmulas de cuadratura, aproximando la integral con las evaluaciones de la funci&oacute;n en determinados puntos con determinadas constantes, el grado de exactitud iba relacionado con que si la funci&oacute;n es un polinomio de grado determinado estas f&oacute;rmulas eran exactas ya que el termino de error se cancelaba Para esta cuadratura usaremos los polinomios de legendre para hacer exacta la aproximaci&oacute;n. Dichos polinomios tienen propiedades interesantes y se ocupan entre -1 y 1</p><p><img src="ASySPrac04CarlosMartinez_eq00081640965886824806.png" alt="$\int_{-1}^{1} e^{-x^2}dx \approx e^{-(0.5773502692)^2}+ e^{-(-0.5773502692)^2}\approx 1.43306  \quad (n=2)$"></p><p>Usando el segundo polinomio de legendre   <img src="ASySPrac04CarlosMartinez_eq04971997569873582397.png" alt="$x^2-\frac{1}{3}$">, <img src="ASySPrac04CarlosMartinez_eq06266092044378493849.png" alt="$\int_{-1}^{1} e^{-x^2}dx \approx 0.5555555556e^{-(0.7745966669)^2}+ 0.8888888889e^{0}+0.5555555556e^{-(-0.7745966669)^2}\approx 1.49868  \quad (n=3)$"> Usando el tercer polinomio de legendre   <img src="ASySPrac04CarlosMartinez_eq05566427342580337810.png" alt="$x^3-\frac{3}{5}x$">. Tomando las ra&iacute;ces de la tabla de legendre para los grados de cada una de las integrales</p><p><b>Polinomios de grado cero en adelante</b></p><p><img src="ASySPrac04CarlosMartinez_eq15937083427082250286.png" alt="${1,x,x^2-\frac{1}{3},x^3-\frac{3}{5}x,x^4-\frac{6}{7}x^2+\frac{3}{35}}$"></p><p><b>Resultado</b> <img src="ASySPrac04CarlosMartinez_eq11785513331722918353.png" alt="$P_{n}$"> es el polinomio de Legrende de grado n <img src="ASySPrac04CarlosMartinez_eq05698082398248232224.png" alt="$x_{1}, x_{2},.., x_{n}$"> son ra&iacute;ces de <img src="ASySPrac04CarlosMartinez_eq15084836845238326044.png" alt="$P_{n}(x)$">  (son n&uacute;meros reales) <img src="ASySPrac04CarlosMartinez_eq12595255900856253740.png" alt="$C_{i}=\int_{-1}^{1}\prod_{i=1}^{n}\frac{x-x_{i}}{x_{0}-x_{i}}dx$"> entonces <img src="ASySPrac04CarlosMartinez_eq03870186809875778737.png" alt="$\int_{-1}^{1}P(x)dx =  \sum_{i=1}^{n} C_{i}P(x_{i})$">; Se debe evaluar <img src="ASySPrac04CarlosMartinez_eq00441311847593852498.png" alt="$P(x)$"> en las ra&iacute;ces de los polinomios de lagrange por las constantes calculadas como se muetra arriba Si son de grado 1,2 o 3 las formulas del trapecio o Simpson son exactas  las aproximaciones</p><h2 id="3">Desarrollo</h2><p>Se plantea la soluci&oacute;n a cinco problemas, donde cada uno requiere del uso de Matlab como herramienta de c&aacute;lculo y an&aacute;lisis.</p><h2 id="4">Ejercicio 1</h2><p>Para el PR04 reporte la grafica de la simulaci&oacute;n n&uacute;merica de la convoluci&oacute;n y compare con el resultado an&aacute;litico que obtuvo para el problema 1, esto es, su pr&aacute;ctica tendr&aacute; que incluir una llamada a la funci&oacute;nn convconm y posteriormente se tendr&aacute; que mostrar (mediante el Publish) la gr&aacute;fica tanto de las se&ntilde;ales involucradas como el resultado de la convoluci&oacute;n, y en esta &uacute;ltima gr&aacute;ficara su resultado analitico, se tendr&aacute; que incluir el resultado analitico.</p><pre class="codeinput">clc; clear; close <span class="string">all</span>;
u = @(t) heaviside(t);
x = @(t) exp(-t).*(u(t)-u(t-1)); <span class="comment">%En programa se implementa --&gt; input('Ingresa la funci&oacute;n x(t):  ');</span>
xl = [0 1];<span class="comment">%En programa se implementa --&gt; input('Ingresa los limites de la funci&oacute;n x(t):  ');</span>

h= @(t) t.*(u(t+1)-u(t-1)); <span class="comment">%En programa se implementa --&gt; input('Ingresa la funci&oacute;n h(t):  ');</span>
hl=[-1 1]; <span class="comment">%En programa se implementa --&gt; input('Ingresa los limites de la funci&oacute;n h(t):  ');</span>
convconm(x,xl,h,hl,u)
t1=-1:0.01:0; t2=0:0.01:1; t3=1:0.01:2; t4=-4:0.01:-1; t5=2:0.01:4;
subplot(1,2,2); hold <span class="string">on</span>
plot(t1,t1-1+2*exp(-t1-1)); plot(t2,t2-1-(t2-2)/exp(1)); plot(t3,-(t3-2)/exp(1)); plot(t4,0); plot(t5,0);
legend(<span class="string">'y(t) numerico'</span>,<span class="string">'t'</span>,<span class="string">'t-1+2*e^(-t-1)'</span>,<span class="string">'t-1-(t-2)/e'</span>,<span class="string">'-(t-2)/e'</span>)
</pre><img vspace="5" hspace="5" src="ASySPrac04CarlosMartinez_01.png" alt=""> <p><img vspace="5" hspace="5" src="E1.jpg" alt=""> </p><h2 id="6">Ejercicio 2</h2><p>Para el PR05 reporte la grafica de la simulaci&oacute;n n&uacute;merica de la correalci&oacute;n y compare con el resultado an&aacute;litico que obtuvo para el problema e), esto es, su pr&aacute;ctica tendr&aacute; que incluir una llamada a la funci&oacute;nn convconm y posteriormente se tendr&aacute; que mostrar (mediante el Publish) la gr&aacute;fica tanto de las se&ntilde;ales involucradas como el resultado de su correlaci&oacute;n, y en esta &uacute;ltima graficara su resultado analitico, se tendr&aacute; que incluir el resultado analitico.</p><pre class="codeinput">clc; clear; close <span class="string">all</span>;
u = @(t) heaviside(t);
h = @(t) u(t)-2*u(t-3)+u(t-4); <span class="comment">%En programa se implementa --&gt; input('Ingresa la funci&oacute;n x(t):  ');</span>
xl = [0 4];<span class="comment">%En programa se implementa --&gt; input('Ingresa los limites de la funci&oacute;n x(t):  ');</span>
x = @(t) -u(t)+2*u(t+3)-u(t+4);
convconm1(x,xl,h,u)
t1=-6:0.01:-4; t2=-4:0.01:-3; t3=-3:0.01:-1; t4=-1:0.01:0; t5=0:0.01:1; t6=1:0.01:3; t7=3:0.01:4; t8=4:0.01:6;
subplot(1,2,2); hold <span class="string">on</span>
plot(t1,0); plot(t2,-(4+t2)); plot(t3,t3+2); plot(t4,3*t4+4); plot(t5,4-3*t5); plot(t6,2-t6); plot(t7,t7-4); plot(t8,0);
legend(<span class="string">'y(t) numerico'</span>,<span class="string">'t'</span>,<span class="string">'0'</span>,<span class="string">'-(4+t)'</span>,<span class="string">'t+2'</span>,<span class="string">'3t+4'</span>,<span class="string">'4-3t'</span>,<span class="string">'2-t'</span>,<span class="string">'t-4'</span>,<span class="string">'0'</span>)
</pre><img vspace="5" hspace="5" src="ASySPrac04CarlosMartinez_02.png" alt=""> <p><img vspace="5" hspace="5" src="E2.jpg" alt=""> </p><h2 id="8">Ejercicio 3</h2><p>Realice la simuaci&oacute;n de la convoluci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1.1</p><pre class="codeinput">n=0:20;
x1=[0 0 0 0 0 0 0 -9 -6 -3 0 3 6 9 0 0 0 0 0 0 0];
x2=[0 0 0 0 0 0 0 0 4 2 0 2 4 0 0 0 0 0 0 0 0];
convdisc([n;x1],[n;x2])
</pre><img vspace="5" hspace="5" src="ASySPrac04CarlosMartinez_03.png" alt=""> <h2 id="9">Ejercicio 4</h2><p>Realice la simuaci&oacute;n de la correlaci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1.1</p><pre class="codeinput">n=0:20;
x2=[0 0 0 0 0 0 0 9 6 3 0 -3 -6 -9 0 0 0 0 0 0 0];
x1=[0 0 0 0 0 0 0 0 4 2 0 2 4 0 0 0 0 0 0 0 0];
cordisc([n;x1],[n;-x2])
</pre><img vspace="5" hspace="5" src="ASySPrac04CarlosMartinez_04.png" alt=""> <h2 id="10">Ejercicio 5</h2><p>Realice la la convoluci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1.1 utilizando el comando conv de MATLAB, muestre el c&oacute;digo utilizado y gr&aacute;fique el resultado, sugerencia: Utilice las propiedades de traslaci&oacute;n de la convoluci&oacute;n.</p><pre class="codeinput">clc; clear <span class="string">all</span>; close <span class="string">all</span>

subplot(3, 1, 1)
n1 = [-6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6];
x1 = [0 0 0 -9 -6 -3 0 3 6 9 0 0 0];
stem(n1, x1, <span class="string">'filled'</span>, <span class="string">'red'</span>); axis([-8 8 -10 10]);
set(gca,<span class="string">'Color'</span>,[0.945098042488098 0.968627452850342 0.949019610881805], <span class="string">'XGrid'</span>,<span class="string">'on'</span>,<span class="string">'YGrid'</span>,<span class="string">'on'</span>)
title(<span class="string">'c): x1[n]'</span>);
xlabel(<span class="string">'n'</span>)
ylabel(<span class="string">'x1[n]'</span>)

subplot(3, 1, 2)
n2 = [-5 -4 -3 -2 -1 0 1 2 3 4 5];
x2 = [0 0 0 4 2 0 2 4 0 0 0];
stem(n2, x2, <span class="string">'filled'</span>, <span class="string">'green'</span>); axis([-8 8 -2 7]);
set(gca,<span class="string">'Color'</span>,[0.945098042488098 0.968627452850342 0.949019610881805],<span class="string">'XGrid'</span>,<span class="string">'on'</span>,<span class="string">'YGrid'</span>,<span class="string">'on'</span>)
title(<span class="string">'d): x2[n]'</span>);
xlabel(<span class="string">'n'</span>)
ylabel(<span class="string">'x2[n]'</span>)

subplot(3, 1, 3)
g = conv (x1, x2);
ng = -11:11;
stem(ng, g, <span class="string">'filled'</span>, <span class="string">'magenta'</span>); axis([-15 15 -50 50]);
set(gca,<span class="string">'Color'</span>,[0.945098042488098 0.968627452850342 0.949019610881805],<span class="string">'XGrid'</span>,<span class="string">'on'</span>,<span class="string">'YGrid'</span>,<span class="string">'on'</span>)
title(<span class="string">'Convoluci&oacute;n g[n] = x1[n]*x2[n]'</span>);
xlabel(<span class="string">'n'</span>)
ylabel(<span class="string">'g[n]'</span>)
</pre><img vspace="5" hspace="5" src="ASySPrac04CarlosMartinez_05.png" alt=""> <h2 id="11">Apendice A</h2><p>Puede consultar los codigos de programaci&oacute;n de cada uno de los ejercicios en la siguiente <a href="https://drive.google.com/open?id=1M2Llttzbg_FAM7OpAit81kZCiaLKFyxO">carpeta</a></p><h2 id="12">Referencias</h2><div><ol><li>Lathi, B. (2005). <i>Linear Systems and Signals</i>. E.U.A.: Oxford University Press</li><li>Moore, H. (2009). <i>MATLAB for Engineers.</i> E.U.A.: Prentice Hall.</li><li>Ashok Ambardar. (1999). Analog and Digital Signal Processing. M&eacute;xico D. F., M&eacute;xico: BROOKS/COLE PUBLISHING COMPANY.</li><li>Hwei P. Hsu. (2013). Se&ntilde;ales y Sistemas. M&eacute;xico D. F., M&eacute;xico: McGrawHill.</li></ol></div><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div><!--
##### SOURCE BEGIN #####
%%
%
% <<portada.png>>
%% Objetivos
% * Conocer métodos básicos de integracíon numérica
% * Manipulación de instrucciones en MATLAB
% * Simular convoluciones y correlaciones de señales continuas
% * Simular convoluciones y correlaciones de señales discretas
%% Introducción
% *Métodos numéricos*
%
% $\int_{a}^{b}f(x)dx$ Es el área definida por la gráfica de la función.
% El teorema fundamental del cálculo dice: que si f es integrable y una anti derivada da como resultado la función f
% Entonces el numero asociado a la idea geométrica evaluado en el intervalo (a,b) se puede calcular como F(b)- F(a)
% Para encontrar estas antiderivadas se usan técnicas de integración (cambio de variable, fracciones parciales, sustitución trigonométrica) recordando que toda función continua es integrable.
%
% De no encontrar la antiderivada, se tiene que tratar de construir un polinomio que al evaluar la función original sean casi la misma altura, e integrar el polinomio que sería casi idéntico a la función original.
% En integración numérica sustituyes funciones por polinomios e integramos los polinomios
% 
% Ejemplo: Integracion Numerica
% $\int_{-1}^{1} f(x)dx = \int_{-1}^{1} e^{-x^2}dx = F(1)-F(-1) \quad con \frac{dF(x)}{dx}=f(x)$; la antiderivada F(x) no existe usando métodos de integración entonces utilizamos la aproximación de área mediante los polinomios de Lagrage
% aproximando P(x) nos queda como un rectángulo entonces P(x)=1 entonces:$\int_{-1}^{1} P(x)dx =\int_{-1}^{1}dx = 2$, $\int_{-1}^{1} e^{-x^2}dx <2$
% Usando software para hacer la integral nos da que e^{-x^2} dx = 1.49365 por lo que nuestra aproximación es correcta con casi .5 de error de aproximación
%
% *Formulas cerradas de newton cotes*
%
% Se utilizan los polinomios de integración de legrange para aproximar el polinomio a la función original
% $\int_{a}^{b}f(x)dx$, $f(x)=P(x)+ \frac{f^{(n+1)} \epsilon(x)}{(n+1)!}(x-x_{0})(x-x_{1})...(x-x_{n})$
% en lugar de integrar la función integremos el polinomio con el error $\epsilon$, estas fórmulas se llaman n más un punto, donde necesitas un punto más del grado del polinomio que se desea
%
% *Formula cerrada de (n+1) puntos de Newton Cotes*
%
% $x_{0}=a$    (punto inicial del intervalo)
% $x_{n}=b$       (punto final del intervalo)
% $h= \frac{b-a}{n}$             (paso)
% $x_{i}= x_{0} +ih$, i=0,1,2,…,n (puntos intermedios del intervalo) donde cada una de estas x son intervalos de las abscisas y h la separación entre ellas
%
% *Regla del trapecio (n=1)*
%
% $\int_{x_{0}}^{x_{1}}f(x)dx =\frac{h}{2}[f(x_{0})+f(x_{1})]-\frac{h^3}{12}f''(\epsilon)$, $x_{0} < \epsilon < x_{1}$
% es para un polinomio grado 1. Y sustituyendo los polinomios de lagrange se integra toda la función y se utilizan dos puntos de interpolación en este caso $x_{0}$ y $x_{1}$ grado de precisión……. Se busca que la aproximación tenga error 0
% la suma de los 2 terminos que nos da esta regla deben aproximarse al calculo de la integral del polinomio del la formula general
% 
% $\int_{-1}^{1} e^{-x^2}dx=\frac{2}{2}[e^{-1}+e^{-1}]-\frac{8}{12}[-2e^{-\epsilon^{2}}(1-\epsilon^{2})]$; $-1<\epsilon<1$; entonces: $\int_{-1}^{1} e^{-x^2}dx =0.735759 + \frac{4}{3}e^{-\epsilon^{2}}(1-\epsilon^{2})$; $-1<\epsilon<1$
% No sabemos el valor de $\epsilon$ solo que esta entre -1 y 1 la aproximación es buena pero no la mejor.
%
% *Regla de Simpson(n=2)*
%
% $\int_{x_{0}}^{x_{2}}f(x)dx =\frac{h}{3}[f(x_{0})+4f(x_{1})+f(x_{2})]-\frac{h^5}{90}f^{4}(\epsilon)$, $x_{0} < \epsilon < x_{2}$
% para este método necesitamos 3 intervalos $x_{0} , x_{1}$ y $x_{2}$ usando una parábola y buscando el área bajo ella para un polinomio de grado 2 
%
% $\int_{-1}^{1} e^{-x^2}dx =\frac{1}{3}[e^{-1}+4e^{0}+e^{-1}]-\frac{1}{90}[-4e^{-\epsilon^{2}}(-4\epsilon^{4} +12\epsilon^{2}-3)]\\$; $-1<\epsilon<1$
% Entoces:$\int_{-1}^{1} e^{-x^2}dx =1.57859 - \frac{2}{45}e^{-\epsilon^{2}}(4\epsilon^{4} -12\epsilon^{2}+3)\\$
% Esta aproximación es mejor que la anterior ya que 1.5 es mas cercano a 1.49 que 0.74
%
% *Regla de  $\frac{3}{8}$ de simpsons (n=3)*
%
% $\int_{x_{0}}^{x_{3}}f(x)dx =\frac{3}{8}h[f(x_{0})+3f(x_{1})+3f(x_{2})+f(x_{3})]-\frac{3}{80}h^5f^4(\epsilon)$; $x_{0} < \epsilon < x_{3}$
% para grado 3 se necesitan 4 puntos para hacer la aproximación, $x_{0} , x_{1} , x_{2}$ y $x_{3}$
% las formulas de newton cotes son exactas entonces el error es 0 ya que la cuarta derivada de un polinomio grado 3 es 0
%
% \int_{-1}^{1} e^{-x^2}dx = \frac{3}{8}(\frac{2}{3})[e^{-1}+3e^{\frac{1}{3}}+3e^{\frac{1}{3}}+e^{-1}]-\frac{3}{8}(\frac{2}{3})^2[-4e^{-\epsilon^{2}}(-4\epsilon^{4} +12\epsilon^{2}-3)]\\
% Entonces:$\int_{-1}^{1} e^{-x^2}dx =1.768- \frac{8}{405}e^{-\epsilon^{2}}(4\epsilon^{4} -12\epsilon^{2}+3)\\$; La aproximación ahora es mas exacta ya que pasa por mas puntos.
%
% *Regla compuesta del trapecio*
%
% $\int_{a}^{b}f(x)dx =\frac{h}{2}[f(a)+2\sum_{i=1}^{n=1}f(x_{i})+f(b)]-\frac{b-a}{12}h^2 f''(u)$, $u(a,b)$
% Es idéntica a la regla del trapecio mencionada antes, solo que en este caso se utilizan múltiples trapecios para aproximar más el valor real de la altura, se manipula el error y el termino de ajuste con lleva la segunda derivada de un numero u entre el intervalo a y b.
% En este caso la n no es el grado del polinomio si no el número de subintervalos, damos por hecho que aproximamos con polinomios de primer grado
% Los puntos intermedios se siguen calculando de la misma manera al igual que el paso.
% 
% $\int_{-1}^{1} e^{-x^2}dx = \frac{0.2}{2}[e^{-1}+2\sum_{i=1}^{n-1}e^{-x^2_{i}}+e^{-1}]-\frac{2}{12}(0.2)^2[-2e^{-u^{2}}(1-2u^{2})]; -1<u<1$
% Entonces: $\int_{-1}^{1} e^{-x^2}dx =1.4887-0.0313e^{-u^{2}}(1-2u^{2})$; Entre más trapecios usemos mayor será la aproximación a la función original
%
% *Regla compuesta de Simpson*
% 
% $\int_{a}^{b}f(x)dx =\frac{h}{3}[f(a)+2\sum_{i=1}^{(n/2)-1}f(x_{2j})+4\sum_{i=1}^{n/2}f(x_{2j-1})+f(b)]-\frac{b-a}{180}h^4 f^4 (u)$; $u(a,b)$
% Los puntos medios pares forman parte de 2 parabolas entonces se suman 2 veces en la formula y los impares se consideran 4 veces dada a forma de la formula simple de Simpson, 
% De igual manera n es el numero de subintervalos , el paso y distancia entre subintervalos se calculan de igual manera 
% 
% \int_{-1}^{1} e^{-x^2}dx = \frac{0.2}{3}[e^{-1}+2\sum_{i=1}^{4}e^{-x^2_{2i}}+4\sum_{i=1}^{5}e^{-x^2_{2i-1}}+e^{-1}]-\frac{2}{180}(0.2)^4[-4e^{-u^{2}}(-4u^{4} +12u^{2}-3)]; -1<u<1$
% Entonces: $\int_{-1}^{1} e^{-x^2}dx =1.4936-0.00007111e^{-u^{2}}(4u^{4}-12u^{2}+3)$
% Entre más parábolas usemos mejor será la aproximación.
%
% *Cuadratura gaussiana*
% 
% $\int_{a}^{b}f(x)dx \approx  \sum_{i=1}^{n} C_{i}f(x_{i}); \quad 2n\quad$  parámetros
% Las reglas vistas anteriormente son fórmulas de cuadratura, aproximando la integral con las evaluaciones de la función en determinados puntos con determinadas constantes, el grado de exactitud iba relacionado con que si la función es un polinomio de grado determinado estas fórmulas eran exactas ya que el termino de error se cancelaba
% Para esta cuadratura usaremos los polinomios de legendre para hacer exacta la aproximación.
% Dichos polinomios tienen propiedades interesantes y se ocupan entre -1 y 1 
% 
% $\int_{-1}^{1} e^{-x^2}dx \approx e^{-(0.5773502692)^2}+ e^{-(-0.5773502692)^2}\approx 1.43306  \quad (n=2)$
% 
% Usando el segundo polinomio de legendre   $x^2-\frac{1}{3}$, $\int_{-1}^{1} e^{-x^2}dx \approx 0.5555555556e^{-(0.7745966669)^2}+ 0.8888888889e^{0}+0.5555555556e^{-(-0.7745966669)^2}\approx 1.49868  \quad (n=3)$
% Usando el tercer polinomio de legendre   $x^3-\frac{3}{5}x$. Tomando las raíces de la tabla de legendre para los grados de cada una de las integrales
%
% *Polinomios de grado cero en adelante*
%
% ${1,x,x^2-\frac{1}{3},x^3-\frac{3}{5}x,x^4-\frac{6}{7}x^2+\frac{3}{35}}$
% 
% *Resultado*
% $P_{n}$ es el polinomio de Legrende de grado n
% $x_{1}, x_{2},.., x_{n}$ son raíces de $P_{n}(x)$  (son números reales)
% $C_{i}=\int_{-1}^{1}\prod_{i=1}^{n}\frac{x-x_{i}}{x_{0}-x_{i}}dx$ entonces $\int_{-1}^{1}P(x)dx =  \sum_{i=1}^{n} C_{i}P(x_{i})$;
% Se debe evaluar $P(x)$ en las raíces de los polinomios de lagrange por las constantes calculadas como se muetra arriba
% Si son de grado 1,2 o 3 las formulas del trapecio o Simpson son exactas  las aproximaciones

%% Desarrollo
% Se plantea la solución a cinco problemas, donde cada uno requiere del
% uso de Matlab como herramienta de cálculo y análisis.
%% Ejercicio 1
% Para el PR04 reporte la grafica de la simulación númerica de la convolución
% y compare con el resultado análitico que obtuvo para el problema 1, esto
% es, su práctica tendrá que incluir una llamada a la funciónn convconm y posteriormente
% se tendrá que mostrar (mediante el Publish) la gráfica tanto de las señales
% involucradas como el resultado de la convolución, y en esta última gráficara
% su resultado analitico, se tendrá que incluir el resultado analitico.
%
clc; clear; close all;
u = @(t) heaviside(t);
x = @(t) exp(-t).*(u(t)-u(t-1)); %En programa se implementa REPLACE_WITH_DASH_DASH> input('Ingresa la función x(t):  ');
xl = [0 1];%En programa se implementa REPLACE_WITH_DASH_DASH> input('Ingresa los limites de la función x(t):  ');

h= @(t) t.*(u(t+1)-u(t-1)); %En programa se implementa REPLACE_WITH_DASH_DASH> input('Ingresa la función h(t):  ');
hl=[-1 1]; %En programa se implementa REPLACE_WITH_DASH_DASH> input('Ingresa los limites de la función h(t):  ');
convconm(x,xl,h,hl,u)
t1=-1:0.01:0; t2=0:0.01:1; t3=1:0.01:2; t4=-4:0.01:-1; t5=2:0.01:4;
subplot(1,2,2); hold on
plot(t1,t1-1+2*exp(-t1-1)); plot(t2,t2-1-(t2-2)/exp(1)); plot(t3,-(t3-2)/exp(1)); plot(t4,0); plot(t5,0);
legend('y(t) numerico','t','t-1+2*e^(-t-1)','t-1-(t-2)/e','-(t-2)/e')
%%
% <<E1.jpg>>
% 
%% Ejercicio 2
% Para el PR05 reporte la grafica de la simulación númerica de la correalción
% y compare con el resultado análitico que obtuvo para el problema e), esto
% es, su práctica tendrá que incluir una llamada a la funciónn convconm y posteriormente
% se tendrá que mostrar (mediante el Publish) la gráfica tanto de las señales
% involucradas como el resultado de su correlación, y en esta última graficara
% su resultado analitico, se tendrá que incluir el resultado analitico.
clc; clear; close all;
u = @(t) heaviside(t);
h = @(t) u(t)-2*u(t-3)+u(t-4); %En programa se implementa REPLACE_WITH_DASH_DASH> input('Ingresa la función x(t):  ');
xl = [0 4];%En programa se implementa REPLACE_WITH_DASH_DASH> input('Ingresa los limites de la función x(t):  ');
x = @(t) -u(t)+2*u(t+3)-u(t+4);
convconm1(x,xl,h,u)
t1=-6:0.01:-4; t2=-4:0.01:-3; t3=-3:0.01:-1; t4=-1:0.01:0; t5=0:0.01:1; t6=1:0.01:3; t7=3:0.01:4; t8=4:0.01:6;
subplot(1,2,2); hold on
plot(t1,0); plot(t2,-(4+t2)); plot(t3,t3+2); plot(t4,3*t4+4); plot(t5,4-3*t5); plot(t6,2-t6); plot(t7,t7-4); plot(t8,0);
legend('y(t) numerico','t','0','-(4+t)','t+2','3t+4','4-3t','2-t','t-4','0')
%%
% 
% <<E2.jpg>>
% 
%% Ejercicio 3
% Realice la simuación de la convolución de las señales (c) con (d) del problema 3.1.1
n=0:20;
x1=[0 0 0 0 0 0 0 -9 -6 -3 0 3 6 9 0 0 0 0 0 0 0];
x2=[0 0 0 0 0 0 0 0 4 2 0 2 4 0 0 0 0 0 0 0 0];
convdisc([n;x1],[n;x2])
%% Ejercicio 4
% Realice la simuación de la correlación de las señales (c) con (d) del problema 3.1.1
n=0:20;
x2=[0 0 0 0 0 0 0 9 6 3 0 -3 -6 -9 0 0 0 0 0 0 0];
x1=[0 0 0 0 0 0 0 0 4 2 0 2 4 0 0 0 0 0 0 0 0];
cordisc([n;x1],[n;-x2])
%% Ejercicio 5
% Realice la la convolución de las señales (c) con (d) del problema 3.1.1 utilizando
% el comando conv de MATLAB, muestre el código utilizado y gráfique el resultado,
% sugerencia: Utilice las propiedades de traslación de la convolución.
clc; clear all; close all

subplot(3, 1, 1)
n1 = [-6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6];
x1 = [0 0 0 -9 -6 -3 0 3 6 9 0 0 0];
stem(n1, x1, 'filled', 'red'); axis([-8 8 -10 10]);
set(gca,'Color',[0.945098042488098 0.968627452850342 0.949019610881805], 'XGrid','on','YGrid','on')
title('c): x1[n]');
xlabel('n') 
ylabel('x1[n]') 

subplot(3, 1, 2)
n2 = [-5 -4 -3 -2 -1 0 1 2 3 4 5];
x2 = [0 0 0 4 2 0 2 4 0 0 0];
stem(n2, x2, 'filled', 'green'); axis([-8 8 -2 7]);
set(gca,'Color',[0.945098042488098 0.968627452850342 0.949019610881805],'XGrid','on','YGrid','on')
title('d): x2[n]');
xlabel('n') 
ylabel('x2[n]') 

subplot(3, 1, 3)
g = conv (x1, x2);
ng = -11:11;
stem(ng, g, 'filled', 'magenta'); axis([-15 15 -50 50]);
set(gca,'Color',[0.945098042488098 0.968627452850342 0.949019610881805],'XGrid','on','YGrid','on')
title('Convolución g[n] = x1[n]*x2[n]');
xlabel('n') 
ylabel('g[n]') 
%% Apendice A
% Puede consultar los codigos de programación de cada uno de los ejercicios
% en la siguiente <https://drive.google.com/open?id=1M2Llttzbg_FAM7OpAit81kZCiaLKFyxO carpeta>
%% Referencias
% # Lathi, B. (2005). _Linear Systems and Signals_. E.U.A.: Oxford University Press
% # Moore, H. (2009). _MATLAB for Engineers._ E.U.A.: Prentice Hall.
% # Ashok Ambardar. (1999). Analog and Digital Signal Processing. México D. F., México: BROOKS/COLE PUBLISHING COMPANY.
% # Hwei P. Hsu. (2013). Señales y Sistemas. México D. F., México: McGrawHill.
##### SOURCE END #####
--></body></html>